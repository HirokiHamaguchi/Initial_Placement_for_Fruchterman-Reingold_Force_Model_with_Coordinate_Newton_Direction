\providecommand{\main}{..}
\documentclass[\main/main]{subfiles}
\setboolean{isMain}{false}

\begin{document}

\title{Report for 2024/07/30}
\author{Hiroki Hamaguchi}
\maketitle

\numberwithin{equation}{section}

\section{Introduction}

problem:
\begin{equation}
    \min f(x)
\end{equation}

descent direction $d_k$:
\begin{equation}\label{eq:defOfDk}
    d_k = \begin{cases}
        -g_k                   & \text{for } k = 1 \\
        -g_k + \beta_k d_{k-1} & \text{for } k > 1
    \end{cases}
\end{equation}

update rule:
\begin{equation}
    x_{k+1} = x_k + \alpha_k d_k
\end{equation}

FR method (erratic):
\begin{equation}
    \beta_k^{\mathrm{FR}} = \norm{g_k}^2 / \norm{g_{k-1}}^2
\end{equation}

PR method (preferred) :
\begin{equation}
    \beta_k^{\mathrm{PR}} = \langle g_k , g_k - g_{k-1} \rangle / \norm{g_{k-1}}^2
\end{equation}

HS method (similar to PR) :
\begin{equation}
    \beta_k^{\mathrm{HS}} = \langle g_k ,g_k -g_{k-1} \rangle / \langle d_{k-1}, g_k - g_{k-1} \rangle
\end{equation}

\section{preliminaries}

$s_k \defeq x_{k+1} - x_k$

$y_k \defeq g_{k+1} - g_k$

$d_k$ is a descent direction if $\langle g_k, d_k \rangle < 0$.

angle between $-g_k$ and $d_k$:
\begin{equation}
    \cos \theta_k \defeq - \langle g_k, d_k \rangle / \norm{g_k} \norm{d_k}
\end{equation}

\begin{assumption}\label{assumption:levelSetAndLipschitz}
    \begin{enumerate}
        \item the level set $\calL \defeq \{ x \mid f(x) \leq f(x_1) \}$ is bounded.
        \item there exists some neighborhood $\calN$ of $\calL$ such that,
              for all $x, \overline{x} \in \calN$ there exists $L > 0$ such that
              \begin{equation}
                  \norm{g(x) - g(\overline{x})} \leq L \norm{x - \overline{x}}.
              \end{equation}
    \end{enumerate}
\end{assumption}

This implies there exists a constant $\overline{\gamma}$ such that
\begin{equation}
    \norm{g_k} \leq \overline{\gamma}, \quad \text{for all } x \in \calL.
\end{equation}

Wolfe conditions:
\begin{align}
    f(x_k + \alpha_k d_k)                      & \leq f(x_k) + \sigma_1 \alpha_k \langle g_k, d_k \rangle \\
    \langle g(x_k + \alpha_k d_k), d_k \rangle & \geq \sigma_2 \langle g_k, d_k \rangle
\end{align}
where $0 < \sigma_1 < \sigma_2 < 1$.

More ideal condition:
\begin{equation}\label{eq:moreIdealCondition}
    f(x_k + \alpha_k d_k) \leq f(x_k + \hat{\alpha}_k d_k)
\end{equation}
where $\hat{\alpha}_k$ is the smallest positive stationary point of the function $\xi_k(\alpha) \defeq f(x_k + \alpha d_k)$.

\begin{theorem}
    Suppose that Assumption~\ref{assumption:levelSetAndLipschitz} holds, and $\alpha_k$ satisfies the Wolfe conditions or the more ideal condition~\eqref{eq:moreIdealCondition}.
    Then, Zoutendijk condition holds:
    \begin{equation}
        \sum_{k \leq 1} \cos^2 \theta_k \norm{g_k}^2 < \infty.
    \end{equation}
\end{theorem}

exact line search (orthogonality condition):
\begin{equation}
    \langle g_k, d_{k-1} \rangle = 0
\end{equation}

By \eqref{eq:defOfDk}, we have
\begin{equation}
    \cos \theta_k = \frac{\norm{g_k}}{\norm{d_k}}
\end{equation}

Substituting this in Zoutendijk condition, we have
\begin{equation}
    \sum_{k \leq 1} \frac{\norm{g_k}^4}{\norm{d_k}^2} < \infty
\end{equation}

If $\{ \norm{d_k} / \norm{g_k} \}$ is bounded, then
\begin{equation}
    \lim_{k \to \infty} \norm{g_k} = 0
\end{equation}

However, this is not always the case.
We can only obtain a weaker result:
\begin{equation}\label{eq:weakerResult}
    \liminf_{k \to \infty} \norm{g_k} = 0
\end{equation}

If \eqref{eq:weakerResult} does not hold, then there exists $\gamma > 0$ such that
\begin{equation}\label{eq:gammaCondition}
    \norm{g_k} \geq \gamma, \quad \text{for all } k \geq 1.
\end{equation}
and this implies
\begin{equation}\label{eq:invSquareSumIsFinite}
    \sum_{k \geq 1} \frac{1}{\norm{d_k}^2} < \infty.
\end{equation}

By Zoutendijk, if \eqref{eq:gammaCondition} holds, then
\begin{equation*}
    \norm{d_k}^2 \leq c k,
\end{equation*}
for some constant $c$.

It contradicts \eqref{eq:invSquareSumIsFinite}, so \eqref{eq:gammaCondition} does not hold.

For inexact, we can proceed if
\begin{equation}\label{eq:cosThetaInexactCondition}
    \cos \theta_k \geq c \norm{g_k} / \norm{d_k},
\end{equation}
for some constant $c$.
The rest of the analysis is the same.

strong Wolfe conditions:
\begin{align}
    f(x_k + \alpha_k d_k)                             & \leq f(x_k) + \sigma_1 \alpha_k \langle g_k, d_k \rangle \\
    \abs{ \langle g(x_k + \alpha_k d_k), d_k \rangle} & \geq -\sigma_2 \langle g_k, d_k \rangle
\end{align}
where $0 < \sigma_1 < \sigma_2 < 1$.
If strong Wolfe conditions hold, then FR method gives \eqref{eq:cosThetaInexactCondition}.

\eqref{eq:cosThetaInexactCondition} is equivalent to
\begin{equation}
    \langle g_k, d_k \rangle \leq -c \norm{g_k}^2.
\end{equation}

\begin{equation}
    \beta_k = \max{\beta_k^{\mathrm{PR}}, 0}
\end{equation}

\section{FR method}

definition of $\beta_k$: any scalar such that
\begin{equation}\label{eq:betaKCondition}
    \abs{\beta_k} \leq \beta_k^{\mathrm{FR}}
\end{equation}
for all $k \geq 2$.


\begin{lemma}
    Suppose that Assumption~\ref{assumption:levelSetAndLipschitz} holds.
    \eqref{eq:betaKCondition} with strong Wolfe condition implies
    \begin{equation}
        - \frac{1}{1-\sigma_2} \leq \frac{\langle g_k, d_k \rangle}{\norm{g_k}^2} \leq \frac{2 \sigma_2 -1}{1-\sigma_2}
    \end{equation}
    for all $k \geq 1$.
\end{lemma}
\begin{proof}
    Since $0 < \sigma_2 < \frac{1}{2}$,
    \begin{equation}
        \frac{2 \sigma_2 -1}{1-\sigma_2} < 0.
    \end{equation}

    \begin{align}
        \frac{\langle g_{k+1}, d_{k+1} \rangle}{\norm{g_{k+1}}^2} & = -1 + \beta_{k+1} \frac{\langle g_{k+1}, d_k \rangle}{\norm{g_{k+1}}^2} \notag                        \\
                                                                  & = -1 + \frac{\beta_{k+1}}{\beta_{k+1}^{\mathrm{FR}}} \frac{\langle g_{k+1}, d_k \rangle}{\norm{g_k}^2}
    \end{align}

    \begin{equation*}
        \abs{\beta_{k+1} \langle g_{k+1}, d_k \rangle} \leq -\sigma_2 \abs{\beta_{k+1}} \langle g_k, d_k \rangle
    \end{equation*}

    TO DO
\end{proof}

\section{Related to PR}

We require the sufficient decrease condition:
\begin{equation}\label{eq:sufficientDecreaseCondition}
    \langle g_k, d_k \rangle \leq - \sigma_3 \norm{g_k}^2
\end{equation}
for some constant $0 < \sigma_3 \leq 1$ and for all $k \geq 1$.

From \eqref{eq:defOfDk},
\begin{equation}
    \langle g_k, d_k \rangle = - \norm{g_k}^2 + \beta_k \langle g_k, d_{k-1} \rangle
\end{equation}

If $\langle g_k, d_{k-1} \rangle \leq 0$, then the non-negativity of $\beta_k$ implies \eqref{eq:sufficientDecreaseCondition}.
If \eqref{eq:sufficientDecreaseCondition} does not hold, then $\langle g_k, d_{k-1} \rangle > 0$.

Proof by contradiction, assuming:
\begin{equation}
    \text{for some } \gamma > 0, \quad \norm{g_k} \geq \gamma \text{ for all } k \geq 1.
\end{equation}



\end{document}